# First import the modules
import os
import csv


csvpath = os.path.join("../","Resources", "budget_data.csv")


# Read the csv module
with open(csvpath) as csvfile:

    # CSV reader specifies delimiter and variable that holds contents
    csvreader = csv.reader(csvfile, delimiter=',')

    # Skip the two header rows first 
    next(csvreader)
    next(csvreader)

    # Identify the necessary lists. 

    months = []
    total_profit = []
    profit_change = []

    # Read each row of data after the header and count the number of months in the data
    for row in csvreader:
        months.append(row[0])
        
     # Calculate the net total amount of profit/losses over the entire period   
        total_profit.append(float(row[1]))

    # Calculate the changes in profit/losses over the entire period
    # Loop through to calculate the difference for each year. Add the differences up and then find the average.
        
    for i in range(1,len(total_profit)):
        profit_change.append(total_profit[i] - total_profit[i-1]) 
        profit_average = sum(profit_change)/len(profit_change)

    # Find the greatest increase in profits and the greatest decrease in profits. (Similar to the bonus from VBA HW)
    # Print it out with the corresponding date.
        if profit_change[i] < profit_change[i - 1]:
            max_profit = profit_change[i - 1]
            min_profit = profit_change[i] 

    # Print out the Financial Analysis for the data. Figure out how to print the date with the last two.

    print(f"Total Months:{len(months)}")
    print(f"Total Profit: ${sum(total_profit)}")
    print(f"Average Change: ${profit_average:.2f}")
    print(f"Greatest Increase in Profits:{max_profit}")
    print(f"Greatest Decrease in Profit: {min_profit}")
